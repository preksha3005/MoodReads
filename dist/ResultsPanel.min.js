export class ResultsPanel{constructor(t){if(!t)throw new Error("ResultsPanel requires a container element");if(this.container=t,this.activeAnimations=[],this.prefersReducedMotion=!1,"undefined"!=typeof window&&window.matchMedia){this.prefersReducedMotion=window.matchMedia("(prefers-reduced-motion: reduce)").matches;window.matchMedia("(prefers-reduced-motion: reduce)").addEventListener("change",t=>{this.prefersReducedMotion=t.matches})}}displayBooks(t){if(this.cancelAnimations(),this.clear(),!t||!Array.isArray(t)||0===t.length)return void this.showEmptyState();const e=t.filter(t=>this.validateBook(t));0!==e.length?(e.length<t.length&&console.warn(`Filtered out ${t.length-e.length} invalid book(s) with missing data`),e.forEach((t,e)=>{const o=this.createBookCard(t);this.container.appendChild(o),requestAnimationFrame(()=>{this.animateBookCard(o,e)})})):this.showEmptyState("Some books had incomplete data. Please try a different mood.")}createBookCard(t){const e=document.createElement("article");e.className="book-card",e.setAttribute("role","article"),e.setAttribute("aria-label",`Book: ${t.title} by ${t.author}`),e.setAttribute("tabindex","0");const o=document.createElement("h3");o.className="book-card__title",o.textContent=t.title;const n=document.createElement("p");n.className="book-card__author",n.textContent=`by ${t.author}`;const a=document.createElement("p");return a.className="book-card__description",a.textContent=t.description,e.appendChild(o),e.appendChild(n),e.appendChild(a),e}animateBookCard(t,e){if(this.prefersReducedMotion)return void t.classList.add("book-card--animate");const o=50+100*e/Math.max(1,e);t.style.opacity="0",t.style.transform="translateY(20px)",t.style.willChange="opacity, transform";const n=setTimeout(()=>{t.classList.add("book-card--animate"),setTimeout(()=>{t.style.willChange="auto"},500)},o);this.activeAnimations.push(n)}clear(){this.cancelAnimations(),this.container.innerHTML=""}cancelAnimations(){this.activeAnimations.forEach(t=>clearTimeout(t)),this.activeAnimations=[]}showEmptyState(t="No recommendations found. Try selecting a different mood!"){const e=document.createElement("div");e.className="results-panel__empty",e.textContent=t,this.container.appendChild(e)}validateBook(t){if(!t||"object"!=typeof t)return console.warn("Invalid book object:",t),!1;const e=["title","author","description"].filter(e=>{const o=t[e];return!o||"string"==typeof o&&""===o.trim()});return!(e.length>0)||(console.warn(`Book missing required fields: ${e.join(", ")}`,t),!1)}}